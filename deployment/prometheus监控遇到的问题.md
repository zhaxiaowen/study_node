# 监控

### 生产 grafana 仪表盘整理遇到的问题

> 对应用进行分模块展示 , 每个模块对应一个仪表盘 , 主要是 http 类的指标监控

#### 遇到的问题

* 仪表盘 variable 是通过正则匹配服务前缀 , 结果发现很多模块匹配到的应用数都少了
* 部分服务没有 jvm 数据展示

#### 定位结果

* 应用 metrics 上报的服务名与 apollo 的不同 , 比如说某个字母小写了 , 导致未匹配到服务
* 类似定时任务 ,mq 这些服务的 metrics 上报到 service, 所以 mq 这类服务没有展示出来
* 部分服务注册 prometheus 监控到 consul 异常 , 服务的端口检测就一直没有正常过
* metrics 接口没有数据 , 研发没有接入数据暴露

### 添加应用端口展示图表

#### 问题

* 图表制作好后 , 发现某个应用实际只有 4 个节点 , 但是展示的却有 10 多个节点 , 去登录 , 发现多的 ip 是不存在的 , 但是 pushgateway 上报的状态是 1, 是正常的
